{% extends 'base.html' %}

{% block content %}
<body class="theme-dark">
<div class="profile-container">
    <!-- Right Content Area -->
    <div class="content-area">
        <div id="personal-info" class="content-section active" >
            <h2 class=" fw-bold mb-4" style="font-size: 2rem; text-align: left;">
                Account Details: {{ user.username }}
            </h2>
            <!-- Account details content -->
            <div class="account-grid" id="account-details">
                 <!-- Avatar block -->
                <div class="avatar-block">
                    <img src="{{ user.avatar_presigned or url_for('static', filename='test_avatar.png') }}"
                        class="avatar"
                        alt="Profile avatar">
                </div>
                <hr class="my-3">
                <div class="info-view">
                    <h3 class="mb-2">Profile Description</h5>
                        <p class="profile-description" style="white-space: pre-line;">
                        {{ user.bio or 'No description yet.' }}
                    </p>
                    <p><strong>Username:</strong> {{ user.username }}</p>
                    <p><strong>Email:</strong> {{ user.email }}</p>
                    <p><strong>Contact Info:</strong> {{ user.contact_info or 'Not provided' }}</p>
            
                <button type="button" class="btn btn-primary" onclick="toggleEditMode()">Edit Profile</button>
                <hr class="my-3">
                </div>
                <!-- Example Demos Section -->
                <section id="example-demos" class="demos-section">
                    <h2 class="section-title">Example Demos</h2>

                    <div class="demo-grid">
                        <!-- Demo 1 -->
                        <article class="demo-card">
                            <a class="demo-title" href="#">SUPERDUPER SONG 1</a>
                            <div class="demo-audio">
                                <button class="demo-play" aria-label="Play voice memo">
                                    <svg class="icon-play" viewBox="0 0 24 24" width="22" height="22"><path d="M8 5v14l11-7z"></path></svg>
                                    <svg class="icon-pause" viewBox="0 0 24 24" width="22" height="22"><path d="M6 5h4v14H6zM14 5h4v14h-4z"></path></svg>
                                    <span class="demo-time">0:00</span>
                                </button>
                                <div class="demo-progress"><div class="demo-progress-bar"></div></div>
                                <audio preload="metadata" src="{{ url_for('static', filename='memos/matrix_models_intro.mp3') }}"></audio>
                            </div>
                            <p class="demo-desc">Short voice note explaining the goal of the demo.</p>
                            <span class="demo-badge">Public</span>
                        </article>
                        <article class="demo-card">
                            <a class="demo-title" href="#">SUPERDUPER SONG 2</a>
                            <div class="demo-audio">
                                <button class="demo-play" aria-label="Play voice memo">
                                    <svg class="icon-play" viewBox="0 0 24 24" width="22" height="22"><path d="M8 5v14l11-7z"></path></svg>
                                    <svg class="icon-pause" viewBox="0 0 24 24" width="22" height="22"><path d="M6 5h4v14H6zM14 5h4v14h-4z"></path></svg>
                                    <span class="demo-time">0:00</span>
                                </button>
                                <div class="demo-progress"><div class="demo-progress-bar"></div></div>
                                <audio preload="metadata" src="{{ url_for('static', filename='memos/matrix_models_intro.mp3') }}"></audio>
                            </div>
                            <p class="demo-desc">Short voice note explaining the goal of the demo.</p>
                            <span class="demo-badge">Public</span>
                        </article>
                        <article class="demo-card">
                            <a class="demo-title" href="#">SUPERDUPER SONG 3</a>
                            <div class="demo-audio">
                                <button class="demo-play" aria-label="Play voice memo">
                                    <svg class="icon-play" viewBox="0 0 24 24" width="22" height="22"><path d="M8 5v14l11-7z"></path></svg>
                                    <svg class="icon-pause" viewBox="0 0 24 24" width="22" height="22"><path d="M6 5h4v14H6zM14 5h4v14h-4z"></path></svg>
                                    <span class="demo-time">0:00</span>
                                </button>
                                <div class="demo-progress"><div class="demo-progress-bar"></div></div>
                                <audio preload="metadata" src="{{ url_for('static', filename='memos/matrix_models_intro.mp3') }}"></audio>
                            </div>
                            <p class="demo-desc">Short voice note explaining the goal of the demo.</p>
                            <span class="demo-badge">Public</span>
                        </article>
                        <article class="demo-card">
                            <a class="demo-title" href="#">SUPERDUPER SONG 4</a>
                            <div class="demo-audio">
                                <button class="demo-play" aria-label="Play voice memo">
                                    <svg class="icon-play" viewBox="0 0 24 24" width="22" height="22"><path d="M8 5v14l11-7z"></path></svg>
                                    <svg class="icon-pause" viewBox="0 0 24 24" width="22" height="22"><path d="M6 5h4v14H6zM14 5h4v14h-4z"></path></svg>
                                    <span class="demo-time">0:00</span>
                                </button>
                                <div class="demo-progress"><div class="demo-progress-bar"></div></div>
                                <audio preload="metadata" src="{{ url_for('static', filename='memos/matrix_models_intro.mp3') }}"></audio>
                            </div>
                            <p class="demo-desc">Short voice note explaining the goal of the demo.</p>
                            <span class="demo-badge">Public</span>
                        </article>
                        <!-- You can copy/paste more demo-card blocks here -->
                    </div>
                </section>
                <section id="skills" class="skills-section">
                    <h2 class="skills-title">Skills</h2>

                    <!-- Add form -->
                    <form id="skill-form" class="skill-form" autocomplete="off">
                        <input type="text" id="instrument" placeholder="Instrument (e.g., Guitar)" required>
                        <select id="level" required>
                        <option value="" disabled selected>Experience level</option>
                        <option>Beginner</option>
                        <option>Intermediate</option>
                        <option>Advanced</option>
                        <option>Expert</option>
                        </select>
                        <label class="years-label">
                        <span>Years:</span>
                        <input type="number" id="years" min="0" max="50" step="1" value="1" required>
                        </label>
                        <button type="submit" class="btn-add">Add</button>
                    </form>

                    <!-- Skills list -->
                    <ul id="skills-list" class="skills-list">
                        <!-- items injected by JS -->
                    </ul>
                    </section>

                </div>
            </div>
        </div>      
        <div class="info-edit" id="info-edit" style="display: none;">
            
                <form method="POST"
                        action="{{ url_for('profile.upload_avatar') }}"
                        enctype="multipart/form-data"
                        class="mt-3">
                <div class="form-group">
                    <label for="avatar_file">Upload avatar image</label>
                    <input type="file" id="avatar_file" name="avatar_file" class="form-control" accept="image/*">
                </div>
                    <button type="submit" class="btn btn-primary mt-2">Upload to S3</button>
                </form>

                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" class="form-control" id="username" name="username" value="{{ user.username }}">
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" class="form-control" id="email" name="email" value="{{ user.email }}">
                </div>
                <div class="form-group">
                    <label for="contact_info">Contact Info</label>
                    <input type="text" class="form-control" id="contact_info" name="contact_info" value="{{ user.contact_info }}">
                </div>
                <div class="form-group">
                    <label for="bio">Profile Description</label>
                    <textarea class="form-control" id="bio" name="bio" rows="4"
                                placeholder="Tell others about yourself...">{{ user.bio or '' }}</textarea>
                </div>
                <div class="form-buttons">
                    <button type="submit" class="btn btn-success">Save Changes</button>
                    <button type="button" class="btn btn-secondary" onclick="toggleEditMode()">Cancel</button>
                </div>
                
            </form>
        </div>

        <div id="created-projects" class="content-section">
            <h3>Created Projects</h3>
            <div class="projects-grid">
                {% if user.projects %}
                    {% for project in user.projects %}
                        {% with is_creator=True %}
                            {% include 'project_card.html' %}
                        {% endwith %}
                    {% endfor %}
                {% else %}
                    <p>No projects created yet.</p>
                {% endif %}
            </div>
        </div>

        <div id="active-projects" class="content-section">
            <h3>Active Projects</h3>
            <p>Coming soon...</p>
        </div>

        <div id="favorite-projects" class="content-section">
            <h3>Favorite Projects</h3>
            <p>Coming soon...</p>
        </div>
    </div>
</div>

<script>
// Add this function to toggle between view and edit modes
function toggleEditMode() {
    const accountDetails = document.getElementById('account-details');
    const infoEdit = document.getElementById('info-edit');
    
    if (infoEdit.style.display === 'none') {
        accountDetails.style.display = 'none';
        infoEdit.style.display = 'block';
    } else {
        accountDetails.style.display = 'block';
        infoEdit.style.display = 'none';
    }
}

</script>
{% endblock %}